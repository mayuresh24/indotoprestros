<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Admin Dashboard</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: white;
  padding: 20px;
}
input, button {
  padding: 10px;
  margin: 5px 0;
}
table {
  width: 100%;
  margin-top: 20px;
  border-collapse: collapse;
}
th, td {
  border: 1px solid #334155;
  padding: 8px;
  font-size: 14px;
}
th {
  background: #1e293b;
}
</style>
</head>

<body>

<h2>üîê Admin Login</h2>

<input type="password" id="adminPass" placeholder="Enter Admin Password">
<button id="loginBtn">Login</button>

<div id="content" style="display:none;">
  <h2>üìç Location Data</h2>

  <table id="dataTable">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>Lat</th>
        <th>Lon</th>
        <th>Accuracy</th>
        <th>City</th>
        <th>State</th>
        <th>Country</th>
        <th>Postal</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script type="module">

// NO Firestore read with SDK ‚Üí ONLY REST API READ

document.getElementById("loginBtn").addEventListener("click", async () => {
  
  const pass = document.getElementById("adminPass").value.trim();
  
  if (pass !== "desh21mayu50") {
    alert("‚ùå Wrong password");
    return;
  }

  // Show dashboard
  document.getElementById("content").style.display = "block";

  // REST API URL with password
  const url = `https://firestore.googleapis.com/v1/projects/sample-4d3c3/databases/(default)/documents/locations?password=${pass}`;

  try {
    const res = await fetch(url);
    const json = await res.json();

    console.log("Admin Data:", json);

    const tbody = document.querySelector("#dataTable tbody");
    tbody.innerHTML = "";

    if (!json.documents) {
      tbody.innerHTML = "<tr><td colspan='8'>No data found</td></tr>";
      return;
    }

    json.documents.forEach(doc => {
      const f = doc.fields;

      tbody.innerHTML += `
        <tr>
          <td>${f.timestamp?.stringValue || ""}</td>
          <td>${f.lat?.doubleValue || ""}</td>
          <td>${f.lon?.doubleValue || ""}</td>
          <td>${f.accuracy?.doubleValue || ""}</td>
          <td>${f.city?.stringValue || ""}</td>
          <td>${f.state?.stringValue || ""}</td>
          <td>${f.country?.stringValue || ""}</td>
          <td>${f.postal_code?.stringValue || ""}</td>
        </tr>
      `;
    });

  } catch (err) {
    console.error("‚ùå Error loading data:", err);
    alert("Error loading admin data.");
  }

});

</script>

</body>
</html>
