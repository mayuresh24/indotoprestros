<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Admin Dashboard</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: white;
  padding: 20px;
}
input, button {
  padding: 10px;
  margin: 5px 0;
}
table {
  width: 100%;
  margin-top: 20px;
  border-collapse: collapse;
}
th, td {
  border: 1px solid #334155;
  padding: 8px;
  font-size: 14px;
}
th {
  background: #1e293b;
}
</style>
</head>

<body>

<h2>üîê Admin Login</h2>

<input type="password" id="adminPass" placeholder="Enter Admin Password">
<button id="loginBtn">Login</button>

<div id="content" style="display:none;">
  <h2>üìç Location Data</h2>

  <table id="dataTable">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>Lat</th>
        <th>Lon</th>
        <th>Accuracy</th>
        <th>City</th>
        <th>State</th>
        <th>Country</th>
        <th>Postal</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>

// Real Firestore REST endpoint
const FIRESTORE_URL =
  "https://firestore.googleapis.com/v1/projects/sample-4d3c3/databases/(default)/documents:batchGet";

document.getElementById("loginBtn").addEventListener("click", async () => {
  const pass = document.getElementById("adminPass").value.trim();

  if (pass !== "desh21mayu50") {
    alert("‚ùå Wrong password!");
    return;
  }

  document.getElementById("content").style.display = "block";

  // Firestore POST Request
  const body = {
    documents: ["projects/sample-4d3c3/databases/(default)/documents/locations"],
    admin_password: pass
  };

  const res = await fetch(FIRESTORE_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(body)
  });

  const json = await res.json();
  console.log("ADMIN DATA RAW:", json);

  const tbody = document.querySelector("#dataTable tbody");
  tbody.innerHTML = "";

  json.responses.forEach(r => {
    if (!r.found) return;

    const f = r.found.fields;

    tbody.innerHTML += `
      <tr>
        <td>${f.timestamp?.stringValue || ""}</td>
        <td>${f.lat?.doubleValue || ""}</td>
        <td>${f.lon?.doubleValue || ""}</td>
        <td>${f.accuracy?.doubleValue || ""}</td>
        <td>${f.city?.stringValue || ""}</td>
        <td>${f.state?.stringValue || ""}</td>
        <td>${f.country?.stringValue || ""}</td>
        <td>${f.postal_code?.stringValue || ""}</td>
      </tr>
    `;
  });

});

</script>

</body>
</html>
